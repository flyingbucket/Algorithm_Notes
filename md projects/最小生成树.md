# 最小生成树

## 概念和问题陈述

定义(生成树与最小生成树):
生成树是指一个连通图中的子树, 它包含图中所有顶点, 并且连接了所有顶点, 但不包含回路.
最小生成树(MST)是指连接所有顶点的权重和最小的生成树.

问题:
给定一个无向连通图G=(V,E), 其中V为顶点集, E为边集,边的权重函数W:E->R, 求G的最小生成树(MST), 即在G中, 权重和最小的生成树.
(为了简化问题,假设G中所有边的的权重各不相同)

## 最优子结构性质

定义(树的导出图):
树T的所有顶点记为V,以V为顶点的完全无向图G的边集为E,则对任意E的子集E',称G'=(V,E')为T的一个导出图.

定理(最小生成树的最有子结构性质):
对于某图G的最小生成树T,任意删去一条边,则得到两个子树T1和T2,它们的任意导出图分别为G1和G2,则T1和T2分别是G1和G2的最小生成树.
证明(剪贴法):
W(T)=W(u,v)+W(T1)+W(T2),其中(u,v)为被移除的边,T1,T2为由此产生的子树;设G1,G2为T1,T2的导出图;
假设T1'是G1的最小生成树,$T1'!=T1$,则对于$T'={(u,v)} \union T1' \union T2$,有$W(T')<W(u,v)+W(T1')+W(T2)$,与T是G的最小生成树矛盾.
因此,T1,T2是G1,G2的最小生成树.


## 重叠子问题性质

递归过程可以理解成不断移除边的过程,按不同顺序移除所得到的结果本质上是相同的,从而得到很多重叠子问题.
**由此可见求解此问题可以使用动态规划,但实际上最小生成树问题有一个更强的性质,使得我们可以使用贪心算法来求解**



## 贪心选择属性

含义:
局部最优解也是全局最优解

定理:
设图G=(V,E)的最小生成树是T,A是V的任一子集,边(u,v)是链接A与V-A的最小权重边,则T包含边(u,v).
证明:
设(u,v)不在T中.由附录B的5.1可知,在树中,任意两顶点间总存在唯一的路径,且路径上边的权重之和最小,称为简单路径.
考虑u,v间的简单路径,设该路径上第一条节点两端分别处于A和V-A的边为E1,将E1从T中删除,添加(u,v)到T中,于是得到了总权重更小的生成树,与T是最小生成树矛盾.
因此,T包含边(u,v).


## Prim算法

定义(顶点到顶点集的距离):对于顶点v和顶点集合A,v到A中任意顶点u的简单路径的权重和称为v
到u的距离,定义d(v,A)为$min \{d(v,u)|u \in A \}$.
思路:将V-A维护成一个优先队列Q,Q中每个顶点的key值为该顶点到A的距离.

 